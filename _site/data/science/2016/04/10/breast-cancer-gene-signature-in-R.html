<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Breast cancer gene signature in R</title>
  <meta name="description" content="source("http://bioconductor.org/biocLite.R")">
  
  <meta name="author" content="Ling Cheng">
  <meta name="copyright" content="&copy; Ling Cheng 2016">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="source("http://bioconductor.org/biocLite.R")" />
  <meta property="og:url" content="http://lingcheng99.github.io" />
  <meta property="og:site_name" content="Ling's blog" />
  <meta property="og:title" content="Breast cancer gene signature in R" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://lingcheng99.github.io/assets/logo.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Breast cancer gene signature in R">
  <meta name="twitter:description" content="source("http://bioconductor.org/biocLite.R")">
  <meta name="twitter:image" content="http://lingcheng99.github.io/assets/logo.png">
  <meta name="twitter:url" content="http://lingcheng99.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://lingcheng99.github.io/data/science/2016/04/10/breast-cancer-gene-signature-in-R.html">
  <link rel="alternate" type="application/rss+xml" title="Ling's blog" href="http://lingcheng99.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="Ling's blog">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">Breast cancer gene signature in R</h1>
      <p class="info">by <strong>Ling Cheng</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">April 10, 2016</div>
  <div class="post-categories">
  in 
    
    <a href="/category/Data">Data</a>, 
    
  
    
    <a href="/category/Science">Science</a>
    
  
  </div>
</section>  

<article class="post-content">
  <div class="highlighter-rouge"><pre class="highlight"><code><span class="n">source</span><span class="p">(</span><span class="s2">"http://bioconductor.org/biocLite.R"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">biocLite</span><span class="p">(</span><span class="s2">"breastCancerNKI"</span><span class="p">)</span>
<span class="n">biocLite</span><span class="p">(</span><span class="s2">"genefu"</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">genefu</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">breastCancerNKI</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">Biobase</span><span class="p">)</span>

<span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="p">(</span><span class="n">sig.oncotypedx</span><span class="p">)</span>
<span class="n">data</span><span class="p">(</span><span class="n">nkis</span><span class="p">)</span>
<span class="n">data</span><span class="p">(</span><span class="n">nki</span><span class="p">)</span>
<span class="n">nki.data</span> <span class="o">&lt;-</span> <span class="n">exprs</span><span class="p">(</span><span class="n">nki</span><span class="p">)</span>
<span class="n">nki.clinical</span><span class="o">=</span><span class="n">data.frame</span><span class="p">(</span><span class="n">pData</span><span class="p">(</span><span class="n">nki</span><span class="p">))</span>
</code></pre>
</div>

<p>The dataset nki.data contains gene expression data, with expression profiling for ~25,000 genes from 337 patients. This is typical of gene expression data, with a lot more features than samples. Talk about curse of dimensionality. The second dataset is nki.clinical, with 21 features from 337 patients. Features include tumor size, age, tumor grade, er (estrogen receptor) positive or negative, spread to lymph node or not. This is where I benefited from being a biologist. It is hard to decipher what these abbreviated feature names mean without some knowledge of cancer biology.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">dim</span><span class="p">(</span><span class="n">nki.data</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;24481&lt;/li&gt;
	&lt;li&gt;337&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">dim</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;337&lt;/li&gt;
	&lt;li&gt;21&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<table>
<thead><tr><th></th>&lt;th scope=col&gt;samplename&lt;th scope=col&gt;dataset&lt;th scope=col&gt;series&lt;th scope=col&gt;id&lt;th scope=col&gt;filename&lt;th scope=col&gt;size&lt;th scope=col&gt;age&lt;th scope=col&gt;er&lt;th scope=col&gt;grade&lt;th scope=col&gt;pgr&lt;th scope=col&gt;ellip.h&lt;th scope=col&gt;brca.mutation&lt;th scope=col&gt;e.dmfs&lt;th scope=col&gt;t.dmfs&lt;th scope=col&gt;node&lt;th scope=col&gt;t.rfs&lt;th scope=col&gt;e.rfs&lt;th scope=col&gt;treatment&lt;th scope=col&gt;tissue&lt;th scope=col&gt;t.os&lt;th scope=col&gt;e.os</tr></thead>
<tbody>
	<tr>&lt;th scope=row&gt;NKI_4<td>NKI_4</td><td>NKI</td><td>NKI</td><td>4</td><td>NA</td><td>2</td><td>41</td><td>1</td><td>3</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>4747</td><td>0</td><td>4747</td><td>0</td><td>0</td><td>1</td><td>4744</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_6<td>NKI_6</td><td>NKI</td><td>NKI</td><td>6</td><td>NA</td><td>1.3</td><td>49</td><td>1</td><td>2</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>4075</td><td>0</td><td>4075</td><td>0</td><td>0</td><td>1</td><td>4072</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_7<td>NKI_7</td><td>NKI</td><td>NKI</td><td>7</td><td>NA</td><td>2</td><td>46</td><td>0</td><td>1</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>3703</td><td>0</td><td>3703</td><td>0</td><td>0</td><td>1</td><td>3700</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_8<td>NKI_8</td><td>NKI</td><td>NKI</td><td>8</td><td>NA</td><td>2.8</td><td>48</td><td>0</td><td>3</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>3215</td><td>0</td><td>3215</td><td>0</td><td>0</td><td>1</td><td>3213</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_9<td>NKI_9</td><td>NKI</td><td>NKI</td><td>9</td><td>NA</td><td>1.5</td><td>48</td><td>1</td><td>3</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>3760</td><td>0</td><td>3760</td><td>0</td><td>0</td><td>1</td><td>3757</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_11<td>NKI_11</td><td>NKI</td><td>NKI</td><td>11</td><td>NA</td><td>2.2</td><td>37</td><td>1</td><td>3</td><td>NA</td><td>⋯</td><td>0</td><td>0</td><td>2120</td><td>0</td><td>2120</td><td>0</td><td>0</td><td>1</td><td>2119</td><td>0</td></tr>
</tbody>
</table>

<p>Look through the features of nki.clinical. There are several possible target variables. ‘dmfs’ stands for distant metastasis free survival. ‘rfs’ stands for remission-free survial, and ‘os’ for overall survival. ‘t’ for number of days, as continuous variable, and ‘e’ for events, as binary variable. These patients have been followed up for at least five years. After reading the original paper and other literature, e.dmfs is selected as target variable.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#plot here but don't need it for the blog
</span><span class="n">nki.annot</span> <span class="o">&lt;-</span> <span class="n">nki</span><span class="o">@</span><span class="n">featureData</span><span class="o">@</span><span class="n">data</span>
<span class="n">rs.nki</span> <span class="o">&lt;-</span> <span class="n">oncotypedx</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">nki.data</span><span class="p">),</span> <span class="n">annot</span> <span class="o">=</span> <span class="n">subset</span><span class="p">(</span><span class="n">nki.annot</span><span class="p">,</span> <span class="o">!</span><span class="n">is.na</span><span class="p">(</span><span class="n">EntrezGene.ID</span><span class="p">)),</span> <span class="n">do.mapping</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.alldata</span> <span class="o">&lt;-</span> <span class="n">subset</span><span class="p">(</span><span class="n">merge</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">,</span> <span class="n">data.frame</span><span class="p">(</span><span class="n">samplename</span> <span class="o">=</span> <span class="n">names</span><span class="p">(</span><span class="n">rs.nki</span><span class="o">$</span><span class="n">score</span><span class="p">),</span> <span class="n">oncotypedx</span> <span class="o">=</span> <span class="n">rs.nki</span><span class="o">$</span><span class="n">score</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="s2">"samplename"</span><span class="p">),</span> <span class="o">!</span><span class="n">is.na</span><span class="p">(</span><span class="n">oncotypedx</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">survfit</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">t.rfs</span><span class="p">,</span> <span class="n">e.rfs</span><span class="p">)</span> <span class="o">~</span> <span class="n">cut</span><span class="p">(</span><span class="n">oncotypedx</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">75</span><span class="p">,</span> <span class="m">101</span><span class="p">)),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">nki.alldata</span><span class="p">))</span>
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_11_0.svg" alt="svg" /></p>

<p>About 80% of all breast cancer are estrogen-receptor-positive. Tumors that are ER-positive are more likely to respond to hormone therapy and generally have better surival rates than ER-engative tumors. This dataset showed the same trend. ER-positive patients have significantly better outcomes, as shown by ttest and density plot</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.clinical</span><span class="o">$</span><span class="n">er</span> <span class="o">=</span> <span class="n">as.factor</span><span class="p">(</span><span class="n">nki.clinical</span><span class="o">$</span><span class="n">er</span><span class="p">)</span>
<span class="n">t.test</span><span class="p">(</span><span class="n">t.dmfs</span><span class="o">~</span><span class="n">er</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>	Welch Two Sample t-test

data:  t.dmfs by er
t = -3.5467, df = 118.15, p-value = 0.0005602
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1113.2280  -315.5176
sample estimates:
mean in group 0 mean in group 1
       1997.203        2711.576
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t.dmfs</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">er</span><span class="p">))</span><span class="o">+</span><span class="n">geom_density</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Warning message:
: Removed 18 rows containing non-finite values (stat_density).
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_14_1.svg" alt="svg" /></p>

<p>BRCA1 and BRCA2 are the best-known genes linked to breast cancer risk, and receive a lot of press coverage lately. This dataset has inforamtion on BRCA mutations for 117 patients, with 18 patients with BRCA1 mutation and 2 patients with BRCA2 mutation. Breast cancer linked with BRCA mutations are generally estrogen-receptor-negative and have less treatment options. Plotting of five-year dmfs showed strongly-reduced surivial.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.clinical</span><span class="o">$</span><span class="n">brca.mutation</span><span class="o">=</span><span class="n">as.factor</span><span class="p">(</span><span class="n">nki.clinical</span><span class="o">$</span><span class="n">brca.mutation</span><span class="p">)</span>
<span class="n">summary</span><span class="p">(</span><span class="n">nki.clinical</span><span class="o">$</span><span class="n">brca.mutation</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;dl class=dl-horizontal&gt;
	&lt;dt&gt;0&lt;/dt&gt;
		&lt;dd&gt;97&lt;/dd&gt;
	&lt;dt&gt;1&lt;/dt&gt;
		&lt;dd&gt;18&lt;/dd&gt;
	&lt;dt&gt;2&lt;/dt&gt;
		&lt;dd&gt;2&lt;/dd&gt;
	&lt;dt&gt;NA’s&lt;/dt&gt;
		&lt;dd&gt;220&lt;/dd&gt;
&lt;/dl&gt;</p>

<p>Among 337 patients, 117 were screened for BRCA mutations. 97 had no BRCA mutations, 18 had BRCA1 mutation and 2 had BRCA2 mutation</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t.dmfs</span><span class="p">))</span><span class="o">+</span><span class="n">geom_histogram</span><span class="p">()</span><span class="o">+</span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">brca.mutation</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Warning message:
: Removed 18 rows containing non-finite values (stat_bin).
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_18_1.svg" alt="svg" /></p>

<p>Lymph node status is considered an important indicator of cancer status and survial. Survival of patients with negative lymph nodes is genereally better than those with positive lymph nodes. But in this study, t.dfms showed no significant difference between node-positive and node-negative patients. Gene expression signature, as discussed below, is a better indicator of cancer status and survival.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.clinical</span><span class="o">$</span><span class="n">node</span><span class="o">=</span><span class="n">as.factor</span><span class="p">(</span><span class="n">nki.clinical</span><span class="o">$</span><span class="n">node</span><span class="p">)</span>
<span class="n">t.test</span><span class="p">(</span><span class="n">t.dmfs</span><span class="o">~</span><span class="n">node</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>	Welch Two Sample t-test

data:  t.dmfs by node
t = -0.42231, df = 311.31, p-value = 0.6731
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -408.6473  264.2286
sample estimates:
mean in group 0 mean in group 1
       2513.263        2585.472
</code></pre>
</div>

<p>Density plot shows a slight left shift for node-positive patients, consistent with the insignicant p-value.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t.dmfs</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">node</span><span class="p">))</span><span class="o">+</span><span class="n">geom_density</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Warning message:
: Removed 18 rows containing non-finite values (stat_density).
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_22_1.svg" alt="svg" /></p>

<p>Tumor grade is an important indicator of cancer survial. This dataset confirmed that based on anova test and density curve</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.clinical</span><span class="o">$</span><span class="n">grade</span> <span class="o">=</span> <span class="n">as.factor</span><span class="p">(</span><span class="n">nki.clinical</span><span class="o">$</span><span class="n">grade</span><span class="p">)</span>
<span class="n">aov</span><span class="p">(</span><span class="n">t.dmfs</span><span class="o">~</span><span class="n">grade</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
   aov(formula = t.dmfs ~ grade, data = nki.clinical)

Terms:
                    grade Residuals
Sum of Squares   26584290 714684554
Deg. of Freedom         2       316

Residual standard error: 1503.882
Estimated effects may be unbalanced
18 observations deleted due to missingness
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">model.tables</span><span class="p">(</span><span class="n">aov</span><span class="p">(</span><span class="n">t.dmfs</span><span class="o">~</span><span class="n">grade</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">nki.clinical</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Tables of effects

 grade
        1   2      3
    344.6 159 -331.2
rep  78.0 108  133.0
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">model.lm</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">t.dmfs</span><span class="o">~</span><span class="n">grade</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">nki.clinical</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">anova</span><span class="p">(</span><span class="n">model.lm</span><span class="p">)</span>
</code></pre>
</div>

<table>
<thead><tr><th></th>&lt;th scope=col&gt;Df&lt;th scope=col&gt;Sum Sq&lt;th scope=col&gt;Mean Sq&lt;th scope=col&gt;F value&lt;th scope=col&gt;Pr(&gt;F)</tr></thead>
<tbody>
	<tr>&lt;th scope=row&gt;grade<td>2</td><td>26584290</td><td>13292145</td><td>5.877163</td><td>0.003118219</td></tr>
	<tr>&lt;th scope=row&gt;Residuals<td>316</td><td>714684554</td><td>2261660</td><td>NA</td><td>NA</td></tr>
</tbody>
</table>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">nki.clinical</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t.dmfs</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">grade</span><span class="p">))</span><span class="o">+</span><span class="n">geom_density</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Warning message:
: Removed 18 rows containing non-finite values (stat_density).
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_28_1.svg" alt="svg" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<p>Through supervised classification and leave-one-out sequential forward selection, van ‘t Veer et al. identified the 70-gene signature and acheivied &gt;90% sensitivity with this signature. I used sig.gene70 for feature selection.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="p">(</span><span class="n">sig.gene70</span><span class="p">)</span>
<span class="n">dim</span><span class="p">(</span><span class="n">sig.gene70</span><span class="p">)</span>
<span class="n">nki.gene70</span> <span class="o">=</span> <span class="n">nki.data</span><span class="p">[</span><span class="n">sig.gene70</span><span class="o">$</span><span class="n">probe</span><span class="p">,]</span>
<span class="n">dim</span><span class="p">(</span><span class="n">nki.gene70</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;70&lt;/li&gt;
	&lt;li&gt;9&lt;/li&gt;
&lt;/ol&gt;</p>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;70&lt;/li&gt;
	&lt;li&gt;337&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">nki.gene70</span><span class="p">)</span>
</code></pre>
</div>

<table>
<thead><tr><th></th>&lt;th scope=col&gt;NKI_4&lt;th scope=col&gt;NKI_6&lt;th scope=col&gt;NKI_7&lt;th scope=col&gt;NKI_8&lt;th scope=col&gt;NKI_9&lt;th scope=col&gt;NKI_11&lt;th scope=col&gt;NKI_12&lt;th scope=col&gt;NKI_13&lt;th scope=col&gt;NKI_14&lt;th scope=col&gt;NKI_17&lt;th scope=col&gt;&lt;th scope=col&gt;NKI_393&lt;th scope=col&gt;NKI_394&lt;th scope=col&gt;NKI_395&lt;th scope=col&gt;NKI_396&lt;th scope=col&gt;NKI_397&lt;th scope=col&gt;NKI_398&lt;th scope=col&gt;NKI_401&lt;th scope=col&gt;NKI_402&lt;th scope=col&gt;NKI_403&lt;th scope=col&gt;NKI_404</tr></thead>
<tbody>
	<tr>&lt;th scope=row&gt;NM_003748<td>0.231 </td><td>0.159 </td><td>0.047 </td><td>-0.123</td><td>0.072 </td><td>0.011 </td><td>0.074 </td><td>0.324 </td><td>0.126 </td><td>0.126 </td><td>⋯     </td><td>0.138 </td><td>-0.105</td><td>0.026 </td><td>0.369 </td><td>-0.2  </td><td>-0.156</td><td>0.158 </td><td>-0.009</td><td>-0.175</td><td>-0.326</td></tr>
	<tr>&lt;th scope=row&gt;NM_003862<td>-0.033</td><td>0.219 </td><td>0.77  </td><td>-0.418</td><td>0.186 </td><td>0.336 </td><td>-0.439</td><td>-0.095</td><td>0.226 </td><td>0.568 </td><td>⋯     </td><td>-0.066</td><td>-0.134</td><td>0.082 </td><td>-0.565</td><td>0.32  </td><td>-0.561</td><td>-0.521</td><td>-0.306</td><td>0.107 </td><td>-0.001</td></tr>
	<tr>&lt;th scope=row&gt;Contig32125_RC<td>0.109 </td><td>0.352 </td><td>0.183 </td><td>-0.082</td><td>0.047 </td><td>-0.024</td><td>NaN   </td><td>0.376 </td><td>-0.032</td><td>0.312 </td><td>⋯     </td><td>-0.141</td><td>0.193 </td><td>0.018 </td><td>-0.142</td><td>-0.059</td><td>-0.252</td><td>0.109 </td><td>-0.064</td><td>-0.006</td><td>0.016 </td></tr>
	<tr>&lt;th scope=row&gt;U82987<td>0.125 </td><td>0.394 </td><td>0.007 </td><td>0.139 </td><td>0.278 </td><td>-0.026</td><td>-0.235</td><td>0.179 </td><td>NaN   </td><td>0.235 </td><td>⋯     </td><td>0.081 </td><td>0.164 </td><td>0.164 </td><td>0.112 </td><td>0.111 </td><td>-0.184</td><td>-0.026</td><td>-0.105</td><td>0.114 </td><td>0.175 </td></tr>
	<tr>&lt;th scope=row&gt;AB037863<td>0.456 </td><td>0.319 </td><td>0.323 </td><td>-0.253</td><td>0.294 </td><td>-0.303</td><td>-0.211</td><td>0.121 </td><td>-0.069</td><td>0.433 </td><td>⋯     </td><td>0.017 </td><td>0.319 </td><td>-0.048</td><td>-0.39 </td><td>-0.126</td><td>-0.171</td><td>0.179 </td><td>-0.297</td><td>-0.081</td><td>0.116 </td></tr>
	<tr>&lt;th scope=row&gt;NM_020974<td>-0.628</td><td>0.703 </td><td>-0.218</td><td>-0.098</td><td>0.711 </td><td>-0.424</td><td>-1.18 </td><td>0.075 </td><td>0.881 </td><td>0.301 </td><td>⋯     </td><td>-0.66 </td><td>0.07  </td><td>0.091 </td><td>-1.201</td><td>0.044 </td><td>-0.934</td><td>0.963 </td><td>-0.846</td><td>0.464 </td><td>0.892 </td></tr>
</tbody>
</table>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#transpose the matrix and remove NA
</span><span class="n">nki.gene70</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">nki.gene70</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.X</span> <span class="o">=</span> <span class="n">nki.gene70</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">nki.gene70</span><span class="p">),]</span>
<span class="n">dim</span><span class="p">(</span><span class="n">nki.X</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;318&lt;/li&gt;
	&lt;li&gt;70&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nki.Y</span> <span class="o">=</span> <span class="n">nki.clinical</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">nki.gene70</span><span class="p">),]</span>
<span class="n">dim</span><span class="p">(</span><span class="n">nki.Y</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;318&lt;/li&gt;
	&lt;li&gt;21&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#remove NA cases for e.dmfs
</span><span class="n">nki.Y2</span> <span class="o">=</span> <span class="n">nki.Y</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">nki.Y</span><span class="o">$</span><span class="n">e.dmfs</span><span class="p">),]</span>
<span class="n">dim</span><span class="p">(</span><span class="n">nki.Y2</span><span class="p">)</span>
<span class="n">nki.X2</span> <span class="o">=</span> <span class="n">nki.X</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">nki.Y</span><span class="o">$</span><span class="n">e.dmfs</span><span class="p">),]</span>
<span class="n">dim</span><span class="p">(</span><span class="n">nki.X2</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;300&lt;/li&gt;
	&lt;li&gt;21&lt;/li&gt;
&lt;/ol&gt;</p>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;300&lt;/li&gt;
	&lt;li&gt;70&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">y</span><span class="o">=</span><span class="n">as.factor</span><span class="p">(</span><span class="n">nki.Y2</span><span class="o">$</span><span class="n">e.dmfs</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">data.frame</span><span class="p">(</span><span class="n">nki.X2</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">dim</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre>
</div>

<p>&lt;ol class=list-inline&gt;
	&lt;li&gt;300&lt;/li&gt;
	&lt;li&gt;71&lt;/li&gt;
&lt;/ol&gt;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>NULL
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre>
</div>

<table>
<thead><tr><th></th>&lt;th scope=col&gt;NM_003748&lt;th scope=col&gt;NM_003862&lt;th scope=col&gt;Contig32125_RC&lt;th scope=col&gt;U82987&lt;th scope=col&gt;AB037863&lt;th scope=col&gt;NM_020974&lt;th scope=col&gt;Contig55377_RC&lt;th scope=col&gt;NM_003882&lt;th scope=col&gt;NM_000849&lt;th scope=col&gt;Contig48328_RC&lt;th scope=col&gt;ellip.h&lt;th scope=col&gt;NM_020188&lt;th scope=col&gt;AL137718&lt;th scope=col&gt;Contig28552_RC&lt;th scope=col&gt;Contig38288_RC&lt;th scope=col&gt;AA555029_RC&lt;th scope=col&gt;NM_016359&lt;th scope=col&gt;Contig46218_RC&lt;th scope=col&gt;Contig63649_RC&lt;th scope=col&gt;AL080059&lt;th scope=col&gt;y</tr></thead>
<tbody>
	<tr>&lt;th scope=row&gt;NKI_4<td>0.231</td><td>-0.033</td><td>0.109</td><td>0.125</td><td>0.456</td><td>-0.628</td><td>0.024</td><td>-0.276</td><td>-0.233</td><td>0.426</td><td>⋯</td><td>0.314</td><td>-0.038</td><td>-0.036</td><td>-0.037</td><td>-0.143</td><td>-0.01</td><td>-0.059</td><td>-0.077</td><td>0.235</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_6<td>0.159</td><td>0.219</td><td>0.352</td><td>0.394</td><td>0.319</td><td>0.703</td><td>0.174</td><td>0.134</td><td>0.468</td><td>0.775</td><td>⋯</td><td>-0.279</td><td>-0.194</td><td>-0.365</td><td>0.078</td><td>-0.269</td><td>-0.349</td><td>-0.326</td><td>-0.147</td><td>-0.702</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_7<td>0.047</td><td>0.77</td><td>0.183</td><td>0.007</td><td>0.323</td><td>-0.218</td><td>0.071</td><td>0.377</td><td>0.289</td><td>-0.243</td><td>⋯</td><td>-0.349</td><td>-0.134</td><td>-0.319</td><td>-0.092</td><td>-0.148</td><td>-0.452</td><td>-0.295</td><td>-0.27</td><td>-0.332</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_8<td>-0.123</td><td>-0.418</td><td>-0.082</td><td>0.139</td><td>-0.253</td><td>-0.098</td><td>-0.143</td><td>-0.163</td><td>-0.383</td><td>-0.32</td><td>⋯</td><td>0.094</td><td>0.008</td><td>0.12</td><td>0.131</td><td>-0.14</td><td>0.006</td><td>-0.017</td><td>0.138</td><td>-0.234</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_9<td>0.072</td><td>0.186</td><td>0.047</td><td>0.278</td><td>0.294</td><td>0.711</td><td>-0.168</td><td>0.195</td><td>0.501</td><td>0.322</td><td>⋯</td><td>-0.127</td><td>0.012</td><td>-0.042</td><td>-0.133</td><td>-0.18</td><td>-0.209</td><td>-0.118</td><td>0.12</td><td>-0.553</td><td>0</td></tr>
	<tr>&lt;th scope=row&gt;NKI_11<td>0.011</td><td>0.336</td><td>-0.024</td><td>-0.026</td><td>-0.303</td><td>-0.424</td><td>-0.084</td><td>0.055</td><td>0.202</td><td>-0.541</td><td>⋯</td><td>0.125</td><td>-0.006</td><td>-0.047</td><td>-0.145</td><td>0.034</td><td>0.021</td><td>-0.065</td><td>-0.358</td><td>-0.351</td><td>0</td></tr>
</tbody>
</table>

<p>First test randomforest model</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#install.packages('randomForest',"/home/user/anaconda3/lib/R/library")
</span><span class="n">library</span><span class="p">(</span><span class="n">randomForest</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>randomForest 4.6-12
Type rfNews() to see new features/changes/bug fixes.

Attaching package: ‘randomForest’

The following object is masked from ‘package:ggplot2’:

    margin

The following object is masked from ‘package:Biobase’:

    combine

The following object is masked from ‘package:BiocGenerics’:

    combine
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">sample</span> <span class="p">(</span><span class="m">1</span><span class="o">:</span> <span class="n">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="n">length</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</code></pre>
</div>

<p>150</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">rf.nki</span> <span class="o">=</span> <span class="n">randomForest</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="n">mtyr</span><span class="o">=</span><span class="m">9</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">rf.pred</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">rf.nki</span><span class="p">,</span> <span class="n">newdata</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">,])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">rf.pred</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>rf.pred  0  1
      0 85 42
      1  9 14
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">mean</span><span class="p">(</span><span class="n">rf.pred</span><span class="o">==</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<p>0.66</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#sesitivity/recall
</span><span class="m">14</span><span class="o">/</span><span class="p">(</span><span class="m">14+42</span><span class="p">)</span>
</code></pre>
</div>

<p>0.25</p>

<p>SVM model</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">e1071</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#use the entire dataset and cross-validation
</span><span class="n">tune1</span><span class="o">=</span><span class="n">tune</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span><span class="n">ranges</span><span class="o">=</span><span class="n">list</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">0.0001</span><span class="p">,</span><span class="m">0.001</span><span class="p">,</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">tune1</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Parameter tuning of ‘svm’:

- sampling method: 10-fold cross validation

- best parameters:
 cost
 0.01

- best performance: 0.3

- Detailed performance results:
   cost     error dispersion
1 1e-04 0.3400000 0.04097575
2 1e-03 0.3400000 0.04097575
3 1e-02 0.3000000 0.08606630
4 1e-01 0.3100000 0.08172522
5 1e+00 0.3166667 0.08202679
6 1e+01 0.3300000 0.10116604
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#use c=0.01 for train/test split
</span><span class="n">svm1</span><span class="o">=</span><span class="n">svm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">,],</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span><span class="n">cost</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">svm1.pred</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">svm1</span><span class="p">,</span> <span class="n">newdata</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">,])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">svm1.pred</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>svm1.pred  0  1
        0 90 49
        1  4  7
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">mean</span><span class="p">(</span><span class="n">svm1.pred</span><span class="o">==</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<p>0.646666666666667</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#sensitivity/reacall
</span><span class="m">7</span><span class="o">/</span><span class="p">(</span><span class="m">7+49</span><span class="p">)</span>
</code></pre>
</div>

<p>0.125</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">svm2</span><span class="o">=</span><span class="n">svm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">,],</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span><span class="n">cost</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
<span class="n">svm2.pred</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">svm2</span><span class="p">,</span> <span class="n">newdata</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">,])</span>
<span class="n">table</span><span class="p">(</span><span class="n">svm2.pred</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>svm2.pred  0  1
        0 70 30
        1 24 26
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">mean</span><span class="p">(</span><span class="n">svm2.pred</span><span class="o">==</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">train</span><span class="p">])</span>
</code></pre>
</div>

<p>0.64</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#sensitivity/recall
</span><span class="m">26</span><span class="o">/</span><span class="p">(</span><span class="m">26+30</span><span class="p">)</span>
</code></pre>
</div>

<p>0.464285714285714</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#polynomial kernels
</span><span class="n">tune2</span><span class="o">=</span><span class="n">tune</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'polynomial'</span><span class="p">,</span><span class="n">ranges</span><span class="o">=</span><span class="n">list</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">cost</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="m">1</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">tune2</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Parameter tuning of ‘svm’:

- sampling method: 10-fold cross validation

- best parameters:
 degree cost
      1    1

- best performance: 0.31

- Detailed performance results:
  degree cost     error dispersion
1      1 0.01 0.3400000 0.07665861
2      2 0.01 0.3400000 0.07665861
3      3 0.01 0.3400000 0.07665861
4      1 0.10 0.3400000 0.07665861
5      2 0.10 0.3400000 0.07665861
6      3 0.10 0.3400000 0.07665861
7      1 1.00 0.3100000 0.06488356
8      2 1.00 0.3433333 0.08020037
9      3 1.00 0.3333333 0.08748898
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">tune3</span> <span class="o">=</span> <span class="n">tune</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'radial'</span><span class="p">,</span><span class="n">ranges</span><span class="o">=</span><span class="n">list</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">),</span><span class="n">gamma</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">tune3</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Parameter tuning of ‘svm’:

- sampling method: 10-fold cross validation

- best parameters:
 cost gamma
 0.01   0.5

- best performance: 0.34

- Detailed performance results:
    cost gamma error dispersion
1  1e-02   0.5  0.34 0.07503086
2  1e-01   0.5  0.34 0.07503086
3  1e+00   0.5  0.34 0.07503086
4  1e+01   0.5  0.34 0.07503086
5  1e+02   0.5  0.34 0.07503086
6  1e-02   1.0  0.34 0.07503086
7  1e-01   1.0  0.34 0.07503086
8  1e+00   1.0  0.34 0.07503086
9  1e+01   1.0  0.34 0.07503086
10 1e+02   1.0  0.34 0.07503086
11 1e-02   2.0  0.34 0.07503086
12 1e-01   2.0  0.34 0.07503086
13 1e+00   2.0  0.34 0.07503086
14 1e+01   2.0  0.34 0.07503086
15 1e+02   2.0  0.34 0.07503086
16 1e-02   3.0  0.34 0.07503086
17 1e-01   3.0  0.34 0.07503086
18 1e+00   3.0  0.34 0.07503086
19 1e+01   3.0  0.34 0.07503086
20 1e+02   3.0  0.34 0.07503086
21 1e-02   4.0  0.34 0.07503086
22 1e-01   4.0  0.34 0.07503086
23 1e+00   4.0  0.34 0.07503086
24 1e+01   4.0  0.34 0.07503086
25 1e+02   4.0  0.34 0.07503086
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ROCR</span><span class="p">)</span>
<span class="n">svm.nki</span> <span class="o">=</span><span class="n">svm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span><span class="n">cost</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span><span class="n">probability</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>
<span class="n">pred.svm</span> <span class="o">=</span><span class="n">predict</span><span class="p">(</span><span class="n">svm.nki</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">probability</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>
<span class="n">pred.svm.roc</span><span class="o">=</span><span class="n">prediction</span><span class="p">(</span><span class="n">attr</span><span class="p">(</span><span class="n">pred.svm</span><span class="p">,</span><span class="s1">'probabilities'</span><span class="p">)[,</span><span class="m">2</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">perf.svm</span><span class="o">=</span><span class="n">performance</span><span class="p">(</span><span class="n">pred.svm.roc</span><span class="p">,</span><span class="s1">'tpr'</span><span class="p">,</span><span class="s1">'fpr'</span><span class="p">)</span>

<span class="n">rf.nki</span> <span class="o">=</span><span class="n">randomForest</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="err">.</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">mtyr</span><span class="o">=</span><span class="m">9</span><span class="p">)</span>
<span class="n">pred.rf.roc</span><span class="o">=</span><span class="n">prediction</span><span class="p">(</span><span class="n">as.vector</span><span class="p">(</span><span class="n">rf.nki</span><span class="o">$</span><span class="n">votes</span><span class="p">[,</span><span class="m">2</span><span class="p">]),</span><span class="n">y</span><span class="p">)</span>
<span class="n">perf.rf</span><span class="o">=</span><span class="n">performance</span><span class="p">(</span><span class="n">pred.rf.roc</span><span class="p">,</span><span class="s1">'tpr'</span><span class="p">,</span><span class="s1">'fpr'</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Loading required package: gplots
Warning message:
: package ‘gplots’ was built under R version 3.2.4
Attaching package: ‘gplots’

The following object is masked from ‘package:stats’:

    lowess
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">perf.svm</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">perf.rf</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="n">TRUE</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="s1">'right'</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="s1">'svm'</span><span class="p">,</span><span class="s1">'randomForest'</span><span class="p">),</span><span class="n">text.col</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</code></pre>
</div>

<p><img src="NKIbreastcancer_1_files/NKIbreastcancer_1_64_0.svg" alt="svg" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

</article>





<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http://lingcheng99.github.io/data/science/2016/04/10/breast-cancer-gene-signature-in-R.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
  
    
    
    
    
      <a href="//plus.google.com/share?title=Breast+cancer+gene+signature+in+R&url=http://lingcheng99.github.io/data/science/2016/04/10/breast-cancer-gene-signature-in-R.html"
        onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
        <i class="fa fa-google-plus-square fa-lg"></i>
      </a>
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
      <a href="//www.pinterest.com/pin/create/button/?description=Breast+cancer+gene+signature+in+R&url=http://lingcheng99.github.io/data/science/2016/04/10/breast-cancer-gene-signature-in-R.html&media=http://lingcheng99.github.io/assets/header_image.jpg"
        onclick="window.open(this.href, 'pinterest-share', 'width=550,height=255');return false;">
        <i class="fa fa-pinterest-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('http://lingcheng99.github.io/data/science/2016/04/10/breast-cancer-gene-signature-in-R.html') + '&title=Breast cancer gene signature in R'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
  
</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'bencentra';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Ling's blog</h3>

    <div class="site-navigation">
      
      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:lingcheng99@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">lingcheng99@gmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://github.com/lingcheng99" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">lingcheng99</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.linkedin.com/in/ling-cheng-9937b759" title="Connect with me on LinkedIn">
              <i class="fa fa-linkedin"></i>
              <span class="username">Ling Cheng</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text"></p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script>

$(document).ready(function() {

  // Syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });


});

</script>




  </body>

</html>
